//---------------------------------------------------------------------------

#include <vcl.h>
#pragma hdrstop
#include <Printers.hpp>
#include "Unit1.h"
//---------------------------------------------------------------------------
#pragma package(smart_init)
#pragma resource "*.dfm"
TForm1 *Form1;
//---------------------------------------------------------------------------
__fastcall TForm1::TForm1(TComponent* Owner)
	: TForm(Owner)
{
}
//---------------------------------------------------------------------------
void TForm1::clearmas()
{
for (int i = 0; i < 15; i++) {
a[i]="0";
b[i]="0";
}
}

void TForm1::zap(int x, int y)
{
String s1;
String s2;
ADOConnection1->Connected=false;
String xsc=ExtractFilePath(Application->ExeName);
ADOConnection1->ConnectionString="Provider=Microsoft.Jet.OLEDB.4.0;Data Source="+xsc+"baza.mdb;Persist Security Info=False";
//ADOConnection1->ConnectionString="Provider=SQLOLEDB.1;Password=timur666777;Persist Security Info=True;User ID=t67;Initial Catalog=kafe;Data Source=localhost";
ADOConnection1->Connected=true;
switch (x)
 {
 case 1: switch(y)
		 {
		   case 1:
				   clearmas();
				   Panel1->Visible=false;
				   Panel2->Visible=false;
				   Panel3->Visible=false;
				   Panel6->Visible=false;
				   Panel8->Visible=false;
				   Panel9->Visible=false;
				   Panel10->Visible=false;
				   Panel11->Visible=false;
				   Panel12->Visible=false;
				   Panel13->Visible=false;
				   Panel14->Visible=false;
				   Panel18->Visible=false;
				   Panel6->Visible=true;
				   Panel3->Visible=true;
				   Panel2->Visible=true;
				   Panel1->Visible=true;
				   Button13->Visible=false;
				   Button17->Visible=false;
				   Button4->Visible=false;
				   Button3->Visible=false;
				   Button2->Visible=false;
				   Button2->Visible=true;
				   Button3->Visible=true;
				   Button4->Visible=true;
				   Label1->Caption="Имя пользователя";
				   Label2->Caption="Пароль";
				   Label3->Caption="Статус пользователя";
				   ComboBox1->Items->Clear();
				   ComboBox1->Items->Add("Сотрудник");
				   ComboBox1->Items->Add("Администратор");
				   ADOQuery1->SQL->Text="select * from polzov order by fio asc";
				   ADOQuery1->Active=true;
				   a[1]="Номер п/п";
				   a[2]="Ф.И.О";
				   a[3]="Статус";
				   b[1]="fio";
				   b[2]="status";
				   b[3]="id_chel";
				   adtotab(3, StringGrid1);
				   break;
		   case 2:
					if (Edit1->Text!="" && Edit2->Text!="") {
					ADOQuery1->SQL->Text="insert into polzov(fio, pass, status) values(:fio, :pass, :status)";
					ADOQuery1->Parameters->ParamByName("fio")->Value=Edit1->Text;
					ADOQuery1->Parameters->ParamByName("pass")->Value=Edit2->Text;
					ADOQuery1->Parameters->ParamByName("status")->Value=ComboBox1->Text;
					ADOQuery1->ExecSQL();
					zap(1,1);
					} else ShowMessage("Все поля должны быть заполнены");
					break;
		   case 3:
					if (Edit1->Text!="" && Edit2->Text!="") {
					ADOQuery1->SQL->Text="update polzov set fio=:fio, pass=:pass, status=:status where id_chel=:id_chel";
					ADOQuery1->Parameters->ParamByName("fio")->Value=Edit1->Text;
					ADOQuery1->Parameters->ParamByName("pass")->Value=Edit2->Text;
					ADOQuery1->Parameters->ParamByName("status")->Value=ComboBox1->Text;
					ADOQuery1->Parameters->ParamByName("id_chel")->Value=StringGrid1->Cells[3][StringGrid1->Row];
					ADOQuery1->ExecSQL();
					zap(1,1);
					} else ShowMessage("Все поля должны быть заполнены");
					break;
		   case 4:  ADOQuery1->SQL->Text="select * from polzov order by fio asc";
					ADOQuery1->Active=true;
					adtocb(ComboBox3, "fio");
					break;
		   case 5:  ADOQuery1->SQL->Text="select * from polzov where fio=:fio and pass=:pass";
					ADOQuery1->Parameters->ParamByName("fio")->Value=l;
					ADOQuery1->Parameters->ParamByName("pass")->Value=p;
					ADOQuery1->Active=true;
					if (ADOQuery1->RecordCount>=0) {
					if (Trim(ADOQuery1->FieldByName("status")->Value)=="Администратор") {
					Panel4->Visible=true;
					} else { Panel4->Visible=false; }
					tab=3;
					zap(3,1);
					zap(8,1);
					Panel13->Visible=true;
					StringGrid1->Visible=true;
					Panel15->Visible=false;
					Panel17->Visible=true;
					Edit1->Text=StringGrid1->Cells[1][StringGrid1->Row];
					Edit2->Text=StringGrid1->Cells[2][StringGrid1->Row];
					ComboBox1->Text=StringGrid1->Cells[3][StringGrid1->Row];
					}
					break;
		   case 6:
					ADOQuery1->SQL->Text="delete from polzov where id_chel=:id_chel";
					ADOQuery1->Parameters->ParamByName("id_chel")->Value=StringGrid1->Cells[3][StringGrid1->Row];
					ADOQuery1->ExecSQL();
					zap(1,1);
					break;
		 }
		 break;
 case 2: switch(y)
		 {
		   case 1:
				   clearmas();
				   Panel1->Visible=false;
				   Panel2->Visible=false;
				   Panel3->Visible=false;
				   Panel6->Visible=false;
				   Panel8->Visible=false;
				   Panel9->Visible=false;
				   Panel10->Visible=false;
				   Panel11->Visible=false;
				   Panel12->Visible=false;
				   Panel13->Visible=false;
				   Panel14->Visible=false;
				   Panel18->Visible=false;
				   Panel1->Visible=true;
				   Panel6->Visible=true;
				   Button17->Visible=false;
				   Button13->Visible=false;
				   Button4->Visible=false;
				   Button3->Visible=false;
				   Button2->Visible=false;
				   Button2->Visible=true;
				   Button3->Visible=true;
				   Button4->Visible=true;
				   Label1->Caption="Категория продукта";
				   ADOQuery1->SQL->Text="select * from categoryeda order by name_cat asc";
				   ADOQuery1->Active=true;
				   a[1]="Номер п/п";
				   a[2]="Категория";
				   b[1]="name_cat";
				   b[2]="id_category";
				   adtotab(2, StringGrid1);
				   break;
		   case 2:
					if (Edit1->Text!="") {
					ADOQuery1->SQL->Text="insert into categoryeda(name_cat) values(:name_cat)";
					ADOQuery1->Parameters->ParamByName("name_cat")->Value=Edit1->Text;
					ADOQuery1->ExecSQL();
					zap(2,1);
					}
					break;
		   case 3:
					if (Edit1->Text!="") {
					ADOQuery1->SQL->Text="update categoryeda set name_cat=:name_cat where id_category=:id_category";
					ADOQuery1->Parameters->ParamByName("name_cat")->Value=Edit1->Text;
					ADOQuery1->Parameters->ParamByName("id_category")->Value=StringGrid1->Cells[2][StringGrid1->Row];
					ADOQuery1->ExecSQL();
					zap(2,1);
					}
					break;
		   case 4:  ADOQuery1->SQL->Text="select * from categoryeda order by name_cat asc";
					ADOQuery1->Active=true;
					adtocb(ComboBox1, "name_cat");
					break;
		   case 5:  ADOQuery1->SQL->Text="select * from categoryeda where name_cat=:name_cat";
					ADOQuery1->Parameters->ParamByName("name_cat")->Value=xval1;
					ADOQuery1->Active=true;
					if (ADOQuery1->RecordCount>0) {
					xval1=ADOQuery1->FieldByName("id_category")->Value;
					}
					else xval1=0;
					break;
		   case 6:
					ADOQuery1->SQL->Text="delete from categoryeda where id_category=:id_category";
					ADOQuery1->Parameters->ParamByName("id_category")->Value=StringGrid1->Cells[2][StringGrid1->Row];
					ADOQuery1->ExecSQL();
					zap(2,1);
					break;
		 }
		 break;
 case 3: switch(y)
		 {
		   case 1:
				   zap(6,4);
				   StringGrid2->RowCount=1;
				   StringGrid2->ColCount=2;
				   StringGrid2->ColWidths[0]=200;
				   StringGrid2->ColWidths[1]=100;
				   StringGrid2->Cells[0][0]="Блюдо";
				   StringGrid2->Cells[1][0]="Пропорции";
				   StringGrid2->Cells[2][0]="0";
				   for (int i = 1; i < 100; i++) {
				   StringGrid2->Cells[0][i]="";
				   StringGrid2->Cells[1][i]="";
				   StringGrid2->Cells[2][i]="";
				   }
				   StringGrid4->RowCount=1;
				   StringGrid4->ColCount=4;
				   StringGrid4->ColWidths[0]=100;
				   StringGrid4->ColWidths[1]=100;
				   StringGrid4->Cells[0][0]="Блюдо";
				   StringGrid4->Cells[1][0]="Количество";
				   StringGrid4->Cells[2][0]="Цена";
				   StringGrid4->Cells[3][0]="Сумма";
				   StringGrid4->Cells[4][0]="0";
				   for (int j = 1; j < 100; j++) {
				   StringGrid4->Cells[0][j]="";
				   StringGrid4->Cells[1][j]="";
				   StringGrid4->Cells[2][j]="";
				   StringGrid4->Cells[3][j]="";
				   StringGrid4->Cells[4][j]="0";
				   }
				   clearmas();
				   Panel1->Visible=false;
				   Panel2->Visible=false;
				   Panel3->Visible=false;
				   Panel8->Visible=false;
				   Panel9->Visible=false;
				   Panel10->Visible=false;
				   Panel11->Visible=false;
				   Panel12->Visible=false;
				   Panel13->Visible=false;
				   Panel14->Visible=false;
				   Panel18->Visible=false;
				   Button17->Visible=false;
				   Button13->Visible=false;
				   Button4->Visible=false;
				   Button3->Visible=false;
				   Button2->Visible=false;
				   Button2->Visible=true;
				   Button3->Visible=true;
				   Button4->Visible=true;
				   Button18->Visible=true;
				   Button19->Visible=true;
				   Button20->Visible=true;
				   Button17->Visible=true;
				   Panel13->Visible=true;
				   Panel6->Visible=true;
				   Panel3->Visible=true;
				   Panel2->Visible=true;
				   Panel1->Visible=true;
				   Label1->Caption="Наименование блюда";
				   Label2->Caption="Цена";
				   Label3->Caption="Категория";
				   zap(2,4);
				   ADOQuery1->SQL->Text="select * from blud b, categoryeda c where b.id_category=c.id_category order by name_cat asc";
				   ADOQuery1->Active=true;
				   a[1]="Номер п/п";
				   a[2]="Блюдо";
				   a[3]="Цена";
				   a[4]="Категория";
				   b[1]="nameblud";
				   b[2]="cena";
				   b[3]="name_cat";
				   b[4]="id_blud";
				   adtotab(4, StringGrid1);
				   break;
		   case 2:
					ADOQuery1->SQL->Text="select MAX(id_blud) as ttt from blud";
					ADOQuery1->Active=true;
					if (ADOQuery1->FieldByName("ttt")->IsNull!=true)
						ind=ADOQuery1->FieldByName("ttt")->Value;
					else
						ind=0;
					ind++;
					xval1=ComboBox1->Text;
					zap(2, 5);
					if (Edit1->Text!="" && Edit2->Text!="" && xval1!=0) {
					ADOQuery1->SQL->Text="insert into blud(nameblud, cena, id_category, id_blud) values(:nameblud, :cena, :id_category, :id_blud)";
					ADOQuery1->Parameters->ParamByName("nameblud")->Value=Edit1->Text;
					ADOQuery1->Parameters->ParamByName("cena")->Value=Edit2->Text;
					ADOQuery1->Parameters->ParamByName("id_category")->Value=xval1;
					ADOQuery1->Parameters->ParamByName("id_blud")->Value=ind;
					ADOQuery1->ExecSQL();
					zap(8,2);
					zap(3,1);
					for (int i = 1; i < 100; i++) {
					StringGrid2->Cells[0][i]="0";
					StringGrid2->Cells[1][i]="0";
					StringGrid2->Cells[2][i]="0";
					}
					} else ShowMessage("Все поля должны быть заполнены правильно");
					break;
		   case 3:
					xval1=ComboBox1->Text;
					zap(2, 5);
					if (Edit1->Text!="" && Edit2->Text!="" && xval1!=0) {
					ADOQuery1->SQL->Text="update blud set nameblud=:nameblud, cena=:cena, id_category=:id_category where id_blud=:id_blud";
					ADOQuery1->Parameters->ParamByName("nameblud")->Value=Edit1->Text;
					ADOQuery1->Parameters->ParamByName("cena")->Value=Edit2->Text;
					ADOQuery1->Parameters->ParamByName("id_category")->Value=xval1;
					ADOQuery1->Parameters->ParamByName("id_blud")->Value=StringGrid1->Cells[4][StringGrid1->Row];
					ADOQuery1->ExecSQL();
					zap(8,3);
					zap(3,1);
					} else ShowMessage("Все поля должны быть заполнены правильно");
					break;
		   case 6:
					ADOQuery1->SQL->Text="delete from blud where id_blud=:id_blud";
					ADOQuery1->Parameters->ParamByName("id_blud")->Value=StringGrid1->Cells[4][StringGrid1->Row];
					ADOQuery1->ExecSQL();
					ADOQuery1->SQL->Text="delete from recept where id_blud=:id_blud";
					ADOQuery1->Parameters->ParamByName("id_blud")->Value=StringGrid1->Cells[4][StringGrid1->Row];
					ADOQuery1->ExecSQL();
					zap(3,1);
					break;
		   case 8:
					ADOQuery1->SQL->Text="select MAX(id_kvit) as ttt from kvit";
					ADOQuery1->Active=true;
					if (ADOQuery1->FieldByName("ttt")->IsNull!=true)
						ind=ADOQuery1->FieldByName("ttt")->Value;
					else
						ind=0;
					ind++;
					kind=ind;
					xres=0;
					for (int i = 1; i < StringGrid4->RowCount; i++) {
					xse=StringGrid4->Cells[3][i].ToDouble();
					xres+=xse;
					}
					sr=xres;
					ADOQuery1->SQL->Text="insert into kvit(id_kvit, summa, dataopl, ofic) values(:id_kvit, :summa, :dataopl, :ofic)";
					ADOQuery1->Parameters->ParamByName("id_kvit")->Value=ind;
					ADOQuery1->Parameters->ParamByName("summa")->Value=xres;
					ADOQuery1->Parameters->ParamByName("dataopl")->Value=Date();
					ADOQuery1->Parameters->ParamByName("ofic")->Value=l;
					ADOQuery1->ExecSQL();
					for (int i = 1; i < StringGrid4->RowCount; i++)
					{
					ADOQuery1->SQL->Text="insert into kvitspis(idkvit, bludo, cena, kolvo, idbludo) values(:idkvit, :bludo, :cena, :kolvo, :idbludo)";
					ADOQuery1->Parameters->ParamByName("idkvit")->Value=ind;
					ADOQuery1->Parameters->ParamByName("bludo")->Value=StringGrid4->Cells[0][i];
					ADOQuery1->Parameters->ParamByName("cena")->Value=StringGrid4->Cells[2][i];
					ADOQuery1->Parameters->ParamByName("kolvo")->Value=StringGrid4->Cells[1][i];
					ADOQuery1->Parameters->ParamByName("idbludo")->Value=StringGrid4->Cells[4][i];
					ADOQuery1->ExecSQL();

					ADOQuery1->SQL->Text="select *, s.kolvo as sk from kvitspis k, recept r, skladost s where s.id_sklad=r.idskladprih and k.idbludo=r.id_blud and r.id_blud=:id_blud and k.idkvit=:idkvit";
					ADOQuery1->Parameters->ParamByName("idkvit")->Value=ind;
					ADOQuery1->Parameters->ParamByName("id_blud")->Value=StringGrid4->Cells[4][i];
					ADOQuery1->Active=true;
					while (!ADOQuery1->Eof)
					{
					xxl=ADOQuery1->FieldByName("sk")->Value;
					iid=ADOQuery1->FieldByName("id_sklad")->Value;
					xse=ADOQuery1->FieldByName("stoymzaed")->Value;
					xkvp=ADOQuery1->FieldByName("kolvopr")->Value;

					xs1=ADOQuery1->FieldByName("pogr")->Value;

					xkv=StringGrid4->Cells[1][i].ToDouble()*xkvp/xs1;
					xres=xse*xkv;
					ADOQuery2->SQL->Text="insert into skladrash(naim, stoymzaed, kolvo, edizm, category, data, cena) values(:naim, :stoymzaed, :kolvo, :edizm, :category, :data, :cena)";
					ADOQuery2->Parameters->ParamByName("naim")->Value=ADOQuery1->FieldByName("naim")->Value;
					ADOQuery2->Parameters->ParamByName("stoymzaed")->Value=ADOQuery1->FieldByName("stoymzaed")->Value;
					ADOQuery2->Parameters->ParamByName("edizm")->Value=ADOQuery1->FieldByName("edizm")->Value;
					ADOQuery2->Parameters->ParamByName("category")->Value=ADOQuery1->FieldByName("category")->Value;
					ADOQuery2->Parameters->ParamByName("kolvo")->Value=xkv;
					ADOQuery2->Parameters->ParamByName("data")->Value=Date();
					ADOQuery2->Parameters->ParamByName("cena")->Value=xres;
					ADOQuery2->ExecSQL();
					ADOQuery1->Next();
					if (xxl<=xkv) {
					ADOQuery2->SQL->Text="update skladost set kolvo=:kolvo, cena=:cena where id_sklad=:id_sklad";
					ADOQuery2->Parameters->ParamByName("id_sklad")->Value=iid;
					xkv=0;
					ADOQuery2->Parameters->ParamByName("kolvo")->Value=xkv;
					xres=0;
					ADOQuery2->Parameters->ParamByName("cena")->Value=xres;
					ADOQuery2->ExecSQL();
					}
					else
					{
					ADOQuery2->SQL->Text="update skladost set stoymzaed=:stoymzaed, kolvo=:kolvo, cena=:cena where id_sklad=:id_sklad";
					ADOQuery2->Parameters->ParamByName("id_sklad")->Value=iid;
					xkvp=xxl-xkv;
					xse=ADOQuery1->FieldByName("stoymzaed")->Value;
					ADOQuery2->Parameters->ParamByName("kolvo")->Value=xkvp;
					xres=xse*xkvp;
					ADOQuery2->Parameters->ParamByName("cena")->Value=xres;
					ADOQuery2->ExecSQL();
					}
					}
					}
					if(PrintDialog1->Execute())
					{
					TPrinter *Prntr= Printer();
					TRect r = Rect( 1, 1, Prntr->PageWidth, Prntr->PageHeight);
					Prntr->BeginDoc();
					int w=10;
					int h=0;
					Prntr->Canvas->TextOutW(w,h, "Кафе 67");
					h=h+30;
					Prntr->Canvas->TextOutW(w,h, "Квитанция № "+kind);
					h=h+30;
					Prntr->Canvas->TextOutW(w,h, "Дата заказа: "+Date());
					h=h+30;
					Prntr->Canvas->TextOutW(w,h, "_________________________________________________");
					for (int i = 0; i < StringGrid4->RowCount; i++) {
					h=h+30;
					Prntr->Canvas->TextOutW(w,h, StringGrid4->Cells[0][i]);
					Prntr->Canvas->TextOutW(w+200,h, StringGrid4->Cells[1][i]);
					Prntr->Canvas->TextOutW(w+400,h, StringGrid4->Cells[2][i]);
					Prntr->Canvas->TextOutW(w+600,h, StringGrid4->Cells[3][i]);
					}
					h=h+30;
					Prntr->Canvas->TextOutW(w,h, "_________________________________________________");
					h=h+30;
					Prntr->Canvas->TextOutW(w,h, "Итого: "+sr);
					Prntr->EndDoc();
					}
					zap(3,1);
					break;
		 }
		 break;
 case 4: switch(y)
		 {
		   case 1:
				   clearmas();
				   Panel1->Visible=false;
				   Panel2->Visible=false;
				   Panel3->Visible=false;
				   Panel6->Visible=false;
				   Panel8->Visible=false;
				   Panel9->Visible=false;
				   Panel10->Visible=false;
				   Panel11->Visible=false;
				   Panel12->Visible=false;
				   Panel13->Visible=false;
				   Panel14->Visible=false;
				   Panel18->Visible=false;
				   Panel1->Visible=true;
				   Panel6->Visible=true;
				   Button17->Visible=false;
				   Button13->Visible=false;
				   Button4->Visible=false;
				   Button3->Visible=false;
				   Button2->Visible=false;
				   Button2->Visible=true;
				   Button3->Visible=true;
				   Button4->Visible=true;
				   Label1->Caption="Категория склада";
				   ADOQuery1->SQL->Text="select * from categorysklad order by n_cat asc";
				   ADOQuery1->Active=true;
				   a[1]="Номер п/п";
				   a[2]="Категория";
				   b[1]="n_cat";
				   b[2]="id_category";
				   adtotab(2, StringGrid1);
				   break;
		   case 2:
					if (Edit1->Text!="") {
					ADOQuery1->SQL->Text="insert into categorysklad(n_cat) values(:name_cat)";
					ADOQuery1->Parameters->ParamByName("name_cat")->Value=Edit1->Text;
					ADOQuery1->ExecSQL();
					zap(4,1);
					}
					break;
		   case 3:
					if (Edit1->Text!="") {
					ADOQuery1->SQL->Text="update categorysklad set n_cat=:name_cat where id_category=:id_category";
					ADOQuery1->Parameters->ParamByName("name_cat")->Value=Edit1->Text;
					ADOQuery1->Parameters->ParamByName("id_category")->Value=StringGrid1->Cells[2][StringGrid1->Row];
					ADOQuery1->ExecSQL();
					zap(4,1);
					}
					break;
		   case 4:  ADOQuery1->SQL->Text="select * from categorysklad order by n_cat asc";
					ADOQuery1->Active=true;
					adtocb(ComboBox2, "n_cat");
					break;
		   case 5:  ADOQuery1->SQL->Text="select * from categorysklad where n_cat=:name_cat";
					ADOQuery1->Parameters->ParamByName("name_cat")->Value=xval1;
					ADOQuery1->Active=true;
					if (ADOQuery1->RecordCount>0) {
					xval1=ADOQuery1->FieldByName("id_category")->Value;
					} else xval1=0;
					break;
		   case 6:
					ADOQuery1->SQL->Text="delete from categorysklad where id_category=:id_category";
					ADOQuery1->Parameters->ParamByName("id_category")->Value=StringGrid1->Cells[2][StringGrid1->Row];
					ADOQuery1->ExecSQL();
					zap(4,1);
					break;
		 }
		 break;
 case 5: switch(y)
		 {
		   case 1:
				   clearmas();
				   Panel1->Visible=false;
				   Panel2->Visible=false;
				   Panel3->Visible=false;
				   Panel6->Visible=false;
				   Panel8->Visible=false;
				   Panel9->Visible=false;
				   Panel10->Visible=false;
				   Panel11->Visible=false;
				   Panel12->Visible=false;
				   Panel13->Visible=false;
				   Panel14->Visible=false;
				   Panel18->Visible=false;
				   Panel6->Visible=true;
				   Panel2->Visible=true;
				   Panel1->Visible=true;
				   Button17->Visible=false;
				   Button13->Visible=false;
				   Button4->Visible=false;
				   Button3->Visible=false;
				   Button2->Visible=false;
				   Button2->Visible=true;
				   Button3->Visible=true;
				   Button4->Visible=true;
				   Label1->Caption="Единица измерения";
				   Label2->Caption="Соотношение";
				   ADOQuery1->SQL->Text="select * from ed order by ed_izm asc";
				   ADOQuery1->Active=true;
				   a[1]="Номер п/п";
				   a[2]="Единица измерения";
				   a[3]="Соотношение";
				   b[1]="ed_izm";
				   b[2]="sootnoshenie";
				   b[3]="id_ed";
				   adtotab(3, StringGrid1);
				   break;
		   case 2:
					if (Edit1->Text!="" && Edit2->Text!="") {
					ADOQuery1->SQL->Text="insert into ed(ed_izm, sootnoshenie) values(:ed_izm, :sootnoshenie)";
					ADOQuery1->Parameters->ParamByName("ed_izm")->Value=Edit1->Text;
					ADOQuery1->Parameters->ParamByName("sootnoshenie")->Value=Edit2->Text;
					ADOQuery1->ExecSQL();
					zap(5,1);
					}
					break;
		   case 3:
					if (Edit1->Text!="" && Edit2->Text!="") {
					ADOQuery1->SQL->Text="update ed set ed_izm=:ed_izm, sootnoshenie=:sootnoshenie where id_ed=:id_ed";
					ADOQuery1->Parameters->ParamByName("ed_izm")->Value=Edit1->Text;
					ADOQuery1->Parameters->ParamByName("sootnoshenie")->Value=Edit2->Text;
					ADOQuery1->Parameters->ParamByName("id_ed")->Value=StringGrid1->Cells[3][StringGrid1->Row];
					ADOQuery1->ExecSQL();
					zap(5,1);
					}
					break;
		   case 4:  ADOQuery1->SQL->Text="select * from ed order by ed_izm asc";
					ADOQuery1->Active=true;
					adtocb(ComboBox1, "ed_izm");
					break;
		   case 5:  ADOQuery1->SQL->Text="select * from ed where ed_izm=:ed_izm";
					ADOQuery1->Parameters->ParamByName("ed_izm")->Value=xval1;
					ADOQuery1->Active=true;
					if (ADOQuery1->RecordCount>0) {
					xval1=ADOQuery1->FieldByName("id_ed")->Value;
					} else xval1=0;
					break;
		   case 6:
					ADOQuery1->SQL->Text="delete from ed where id_ed=:id_ed";
					ADOQuery1->Parameters->ParamByName("id_ed")->Value=StringGrid1->Cells[3][StringGrid1->Row];
					ADOQuery1->ExecSQL();
					zap(5,1);
					break;
		 }
		 break;
 case 6: switch(y)
		 {
		   case 1:
				   clearmas();
				   Panel1->Visible=false;
				   Panel2->Visible=false;
				   Panel3->Visible=false;
				   Panel6->Visible=false;
				   Panel8->Visible=false;
				   Panel9->Visible=false;
				   Panel10->Visible=false;
				   Panel11->Visible=false;
				   Panel12->Visible=false;
				   Panel13->Visible=false;
				   Panel14->Visible=false;
				   Panel18->Visible=false;
				   Panel18->Visible=true;
				   Panel14->Visible=true;
				   Panel12->Visible=true;
				   Panel9->Visible=true;
				   Panel8->Visible=true;
				   Panel6->Visible=true;
				   Panel3->Visible=true;
				   Panel2->Visible=true;
				   Panel1->Visible=true;
				   Button17->Visible=false;
				   Button13->Visible=false;
				   Button4->Visible=false;
				   Button3->Visible=false;
				   Button2->Visible=false;
				   Button2->Visible=true;
				   //Button3->Visible=true;
				   Button4->Visible=true;
				   Label1->Caption="Наименование";
				   Label2->Caption="Стоймость за единицу";
				   Label3->Caption="Единица измерения";
				   Label4->Caption="Категория";
				   Label5->Caption="Количество";
				   Label11->Caption="Погрешность при использовании";
				   zap(5,4);
				   zap(4,4);
				   ADOQuery1->SQL->Text="select * from sklad s, ed e, categorysklad c where e.id_ed=s.edizm and s.category=c.id_category order by data desc";
				   ADOQuery1->Active=true;
				   a[1]="Номер п/п";
				   a[2]="Наименование";
				   a[3]="Стоймость за единицу";
				   a[4]="Единица измерения";
				   a[5]="Категория";
				   a[6]="Количество";
				   a[7]="Сумма";
				   a[8]="Погрешность при использовании";
				   a[9]="Дата";
				   b[1]="naim";
				   b[2]="stoymzaed";
				   b[3]="ed_izm";
				   b[4]="n_cat";
				   b[5]="kolvo";
				   b[6]="cena";
				   b[7]="pogr";
				   b[8]="data";
				   b[9]="id_sklad";
				   adtotab(9, StringGrid1);
				   break;
		   case 2:
					xval1=ComboBox1->Text;
					zap(5, 5);
					s1=xval1;
					xval1=ComboBox2->Text;
					zap(4, 5);
					s2=xval1;
					if (Edit1->Text!="" && Edit2->Text!="" && Edit3->Text!="" && Edit6->Text!="" && s1!="0" && s2!="0") {
					ADOQuery1->SQL->Text="insert into sklad(naim, stoymzaed, kolvo, edizm, category, data, cena, pogr) values(:naim, :stoymzaed, :kolvo, :edizm, :category, :data, :cena, :pogr)";
					ADOQuery1->Parameters->ParamByName("naim")->Value=Edit1->Text;
					ADOQuery1->Parameters->ParamByName("stoymzaed")->Value=Edit2->Text;
					ADOQuery1->Parameters->ParamByName("edizm")->Value=s1;
					ADOQuery1->Parameters->ParamByName("category")->Value=s2;
					ADOQuery1->Parameters->ParamByName("kolvo")->Value=Edit3->Text;
					ADOQuery1->Parameters->ParamByName("pogr")->Value=Edit6->Text;
					ADOQuery1->Parameters->ParamByName("data")->Value=DateTimePicker1->Date.DateString();
					xse=Edit2->Text.ToDouble();
					xkv=Edit3->Text.ToDouble();
					xres=xse*xkv;
					ADOQuery1->Parameters->ParamByName("cena")->Value=xres;
					ADOQuery1->ExecSQL();
					zap(9,2);
					zap(6,1);
					} else ShowMessage("Проверьте правильность ввода");
					break;
		   case 3:
					xval1=ComboBox1->Text;
					zap(5, 5);
					s1=xval1;
					xval1=ComboBox2->Text;
					zap(4, 5);
					s2=xval1;
					ADOQuery1->SQL->Text="update sklad set naim=:naim, stoymzaed=:stoymzaed, edizm=:edizm, category=:category, kolvo=:kolvo, data=:data, cena=:cena, pogr=:pogr where id_sklad=:id_sklad";
					ADOQuery1->Parameters->ParamByName("naim")->Value=Edit1->Text;
					ADOQuery1->Parameters->ParamByName("stoymzaed")->Value=Edit2->Text;
					ADOQuery1->Parameters->ParamByName("edizm")->Value=s1;
					ADOQuery1->Parameters->ParamByName("category")->Value=s2;
					ADOQuery1->Parameters->ParamByName("kolvo")->Value=Edit3->Text;
					ADOQuery1->Parameters->ParamByName("data")->Value=DateTimePicker1->Date.DateString();
					ADOQuery1->Parameters->ParamByName("pogr")->Value=Edit6->Text;
					ADOQuery1->Parameters->ParamByName("id_sklad")->Value=StringGrid1->Cells[9][StringGrid1->Row];
					xse=Edit2->Text.ToDouble();
					xkv=Edit3->Text.ToDouble();
					xres=xse*xkv;
					ADOQuery1->Parameters->ParamByName("cena")->Value=xres;
					ADOQuery1->ExecSQL();
					zap(6,1);
					break;
		   case 4:  ADOQuery1->SQL->Text="select * from skladost order by naim asc";
					ADOQuery1->Active=true;
					adtolb(StringGrid3, "naim", "id_sklad");
					break;
		   case 6:
					ADOQuery1->SQL->Text="delete from sklad where id_sklad=:id_sklad";
					ADOQuery1->Parameters->ParamByName("id_sklad")->Value=StringGrid1->Cells[9][StringGrid1->Row];
					ADOQuery1->ExecSQL();
					zap(6,1);
					break;
		   case 7:
					clearmas();
					zap(5,4);
					zap(4,4);
					ADOQuery1->SQL->Text="select * from sklad s, ed e, categorysklad c where e.id_ed=s.edizm and s.naim like :naim and s.category=c.id_category and s.data between :x and :y";
					ADOQuery1->Parameters->ParamByName("x")->Value=DateTimePicker3->Date.DateString();
					ADOQuery1->Parameters->ParamByName("y")->Value=DateTimePicker4->Date.DateString();
					ADOQuery1->Parameters->ParamByName("naim")->Value="%"+Edit8->Text+"%";
					ADOQuery1->Active=true;
					a[1]="Номер п/п";
					a[2]="Наименование";
					a[3]="Стоймость за единицу";
					a[4]="Единица измерения";
					a[5]="Категория";
					a[6]="Количество";
					a[7]="Сумма";
					a[8]="Погрешность при использовании";
					a[9]="Дата";
					b[1]="naim";
					b[2]="stoymzaed";
					b[3]="ed_izm";
					b[4]="n_cat";
					b[5]="kolvo";
					b[6]="cena";
					b[7]="pogr";
					b[8]="data";
					b[9]="id_sklad";
					adtotab(9, StringGrid1);
					break;
		 }
		 break;
 case 7: switch(y)
		 {
		   case 1:
				   clearmas();
				   Panel1->Visible=false;
				   Panel2->Visible=false;
				   Panel3->Visible=false;
				   Panel6->Visible=false;
				   Panel8->Visible=false;
				   Panel9->Visible=false;
				   Panel10->Visible=false;
				   Panel11->Visible=false;
				   Panel12->Visible=false;
				   Panel13->Visible=false;
				   Panel14->Visible=false;
				   Panel18->Visible=false;
				   Panel18->Visible=true;
				   Panel12->Visible=true;
				   Panel9->Visible=true;
				   Panel8->Visible=true;
				   Panel3->Visible=true;
				   Panel2->Visible=true;
				   Panel1->Visible=true;
				   Button17->Visible=false;
				   Button13->Visible=false;
				   Button4->Visible=false;
				   Button3->Visible=false;
				   Button2->Visible=false;
				   Button2->Visible=true;
				   //Button3->Visible=true;
				   //Button4->Visible=true;
				   Label1->Caption="Наименование";
				   Label2->Caption="Стоймость за единицу";
				   Label3->Caption="Единица измерения";
				   Label4->Caption="Категория";
				   Label5->Caption="Количество";
				   zap(5,4);
				   zap(4,4);
				   ADOQuery1->SQL->Text="select * from skladrash s, ed e, categorysklad c where e.id_ed=s.edizm and s.category=c.id_category order by data desc";
				   ADOQuery1->Active=true;
				   a[1]="Номер п/п";
				   a[2]="Наименование";
				   a[3]="Стоймость за единицу";
				   a[4]="Единица измерения";
				   a[5]="Категория";
				   a[6]="Количество";
				   a[7]="Сумма";
				   a[8]="Дата";
				   b[1]="naim";
				   b[2]="stoymzaed";
				   b[3]="ed_izm";
				   b[4]="n_cat";
				   b[5]="kolvo";
				   b[6]="cena";
				   b[7]="data";
				   b[8]="id_sklad";
				   adtotab(8, StringGrid1);
				   break;
		   case 2:
					xval1=ComboBox1->Text;
					zap(5, 5);
					s1=xval1;
					xval1=ComboBox2->Text;
					zap(4, 5);
					s2=xval1;
					ADOQuery1->SQL->Text="insert into skladrash(naim, stoymzaed, kolvo, edizm, category, data, cena) values(:naim, :stoymzaed, :kolvo, :edizm, :category, :data, :cena)";
					ADOQuery1->Parameters->ParamByName("naim")->Value=Edit1->Text;
					ADOQuery1->Parameters->ParamByName("stoymzaed")->Value=Edit2->Text;
					ADOQuery1->Parameters->ParamByName("edizm")->Value=s1;
					ADOQuery1->Parameters->ParamByName("category")->Value=s2;
					ADOQuery1->Parameters->ParamByName("kolvo")->Value=Edit3->Text;
					ADOQuery1->Parameters->ParamByName("data")->Value=DateTimePicker1->Date.DateString();
					xse=Edit2->Text.ToDouble();
					xkv=Edit3->Text.ToDouble();
					xres=xse*xkv;
					ADOQuery1->Parameters->ParamByName("cena")->Value=xres;
					ADOQuery1->ExecSQL();
					zap(7,1);
					break;
		   case 3:
					xval1=ComboBox1->Text;
					zap(5, 5);
					s1=xval1;
					xval1=ComboBox2->Text;
					zap(4, 5);
					s2=xval1;
					ADOQuery1->SQL->Text="update skladrash set naim=:naim, stoymzaed=:stoymzaed, edizm=:edizm, category=:category, kolvo=:kolvo, data=:data, cena=:cena where id_sklad=:id_sklad";
					ADOQuery1->Parameters->ParamByName("naim")->Value=Edit1->Text;
					ADOQuery1->Parameters->ParamByName("stoymzaed")->Value=Edit2->Text;
					ADOQuery1->Parameters->ParamByName("edizm")->Value=s1;
					ADOQuery1->Parameters->ParamByName("category")->Value=s2;
					ADOQuery1->Parameters->ParamByName("kolvo")->Value=Edit3->Text;
					ADOQuery1->Parameters->ParamByName("data")->Value=DateTimePicker1->Date.DateString();
					ADOQuery1->Parameters->ParamByName("id_sklad")->Value=StringGrid1->Cells[8][StringGrid1->Row];
					xse=Edit2->Text.ToDouble();
					xkv=Edit3->Text.ToDouble();
					xres=xse*xkv;
					ADOQuery1->Parameters->ParamByName("cena")->Value=xres;
					ADOQuery1->ExecSQL();
					zap(7,1);
					break;
		   case 6:
					ADOQuery1->SQL->Text="delete from skladrash where id_sklad=:id_sklad";
					ADOQuery1->Parameters->ParamByName("id_sklad")->Value=StringGrid1->Cells[8][StringGrid1->Row];
					ADOQuery1->ExecSQL();
					zap(7,1);
					break;
		   case 7:
					clearmas();
					zap(5,4);
					zap(4,4);
					ADOQuery1->SQL->Text="select * from skladrash s, ed e, categorysklad c where e.id_ed=s.edizm and s.naim like :naim and s.category=c.id_category and s.data between :x and :y";
					ADOQuery1->Parameters->ParamByName("x")->Value=DateTimePicker3->Date.DateString();
					ADOQuery1->Parameters->ParamByName("y")->Value=DateTimePicker4->Date.DateString();
					ADOQuery1->Parameters->ParamByName("naim")->Value="%"+Edit8->Text+"%";
					ADOQuery1->Active=true;
					a[1]="Номер п/п";
					a[2]="Наименование";
					a[3]="Стоймость за единицу";
					a[4]="Единица измерения";
					a[5]="Категория";
					a[6]="Количество";
					a[7]="Сумма";
					a[8]="Дата";
					b[1]="naim";
					b[2]="stoymzaed";
					b[3]="ed_izm";
					b[4]="n_cat";
					b[5]="kolvo";
					b[6]="cena";
					b[7]="data";
					b[8]="id_sklad";
					adtotab(8, StringGrid1);
					break;
		 }
		 break;
 case 8: switch(y)
		 {
		   case 1:
				   clearmas();
				   ADOQuery1->SQL->Text="select * from recept r, blud b, skladost s where b.id_blud=r.id_blud and r.id_blud=:id_blud and r.idskladprih=s.id_sklad order by naim asc";
				   ADOQuery1->Parameters->ParamByName("id_blud")->Value=StringGrid1->Cells[4][StringGrid1->Row];
				   ADOQuery1->Active=true;
				   a[1]="Ингридиент";
				   a[2]="Пропорции";
				   b[1]="naim";
				   b[2]="kolvopr";
				   b[3]="idskladprih";
				   b[4]="id_recept";
				   b[5]="id_blud";
				   adtotab2(2, StringGrid2);
				   break;
		   case 2:
					for (int i = 1; i < StringGrid2->RowCount; i++) {
					ADOQuery1->SQL->Text="insert into recept(id_blud, idskladprih, kolvopr) values(:id_blud, :idskladprih, :kolvopr)";
					ADOQuery1->Parameters->ParamByName("id_blud")->Value=ind;
					ADOQuery1->Parameters->ParamByName("idskladprih")->Value=StringGrid2->Cells[2][i];
					ADOQuery1->Parameters->ParamByName("kolvopr")->Value=StringGrid2->Cells[1][i];
					ADOQuery1->ExecSQL();
					}
					//zap(4,1);
					break;
		   case 3:
					ADOQuery1->SQL->Text="delete from recept where id_blud=:id_blud";
					ADOQuery1->Parameters->ParamByName("id_blud")->Value=StringGrid1->Cells[4][StringGrid1->Row];
					ADOQuery1->ExecSQL();

					for (int i = 1; i < StringGrid2->RowCount; i++) {
					ADOQuery1->SQL->Text="insert into recept(id_blud, idskladprih, kolvopr) values(:id_blud, :idskladprih, :kolvopr)";
					ADOQuery1->Parameters->ParamByName("id_blud")->Value=StringGrid1->Cells[4][StringGrid1->Row];
					ADOQuery1->Parameters->ParamByName("idskladprih")->Value=StringGrid2->Cells[2][i];
					ADOQuery1->Parameters->ParamByName("kolvopr")->Value=StringGrid2->Cells[1][i];
					ADOQuery1->ExecSQL();
					}
					break;
		 }
		 break;
 case 9: switch(y)
		 {
		   case 1:
				   clearmas();
				   Panel1->Visible=false;
				   Panel2->Visible=false;
				   Panel3->Visible=false;
				   Panel6->Visible=false;
				   Panel8->Visible=false;
				   Panel9->Visible=false;
				   Panel10->Visible=false;
				   Panel11->Visible=false;
				   Panel12->Visible=false;
				   Panel13->Visible=false;
				   Panel14->Visible=false;
				   Panel18->Visible=false;
				   Panel9->Visible=true;
				   Panel8->Visible=true;
				   Panel3->Visible=true;
				   Panel2->Visible=true;
				   Panel1->Visible=true;
				   Button17->Visible=false;
				   Button13->Visible=false;
				   Button4->Visible=false;
				   Button3->Visible=false;
				   Button2->Visible=false;
				   Button2->Visible=true;
				   //Button3->Visible=true;
				   //Button4->Visible=true;
				   Button13->Visible=true;
				   Label1->Caption="Наименование";
				   Label2->Caption="Стоймость за единицу";
				   Label3->Caption="Единица измерения";
				   Label4->Caption="Категория";
				   Label5->Caption="Количество";
				   zap(5,4);
				   zap(4,4);
				   ADOQuery1->SQL->Text="select * from skladost s, ed e, categorysklad c where e.id_ed=s.edizm and s.category=c.id_category order by naim asc";
				   ADOQuery1->Active=true;
				   a[1]="Номер п/п";
				   a[2]="Наименование";
				   a[3]="Стоймость за единицу";
				   a[4]="Единица измерения";
				   a[5]="Категория";
				   a[6]="Количество";
				   a[7]="Сумма";
				   a[8]="Погрешность при трансформации";
				   b[1]="naim";
				   b[2]="stoymzaed";
				   b[3]="ed_izm";
				   b[4]="n_cat";
				   b[5]="kolvo";
				   b[6]="cena";
				   b[7]="pogr";
				   b[8]="id_sklad";
				   adtotab(8, StringGrid1);
				   break;
		   case 2:
				   ADOQuery1->SQL->Text="select * from skladost where naim=:naim";
				   ADOQuery1->Parameters->ParamByName("naim")->Value=Edit1->Text;
				   ADOQuery1->Active=true;
				   if (ADOQuery1->RecordCount<=0) {
					xval1=ComboBox1->Text;
					zap(5, 5);
					s1=xval1;
					xval1=ComboBox2->Text;
					zap(4, 5);
					s2=xval1;
					ADOQuery1->SQL->Text="insert into skladost(naim, stoymzaed, kolvo, edizm, category, cena, pogr) values(:naim, :stoymzaed, :kolvo, :edizm, :category, :cena, :pogr)";
					ADOQuery1->Parameters->ParamByName("naim")->Value=Edit1->Text;
					ADOQuery1->Parameters->ParamByName("stoymzaed")->Value=Edit2->Text;
					ADOQuery1->Parameters->ParamByName("edizm")->Value=s1;
					ADOQuery1->Parameters->ParamByName("category")->Value=s2;
					ADOQuery1->Parameters->ParamByName("kolvo")->Value=Edit3->Text;
					ADOQuery1->Parameters->ParamByName("pogr")->Value=Edit6->Text;
					xse=Edit2->Text.ToDouble();
					xkv=Edit3->Text.ToDouble();
					xres=xse*xkv;
					ADOQuery1->Parameters->ParamByName("cena")->Value=xres;
					ADOQuery1->ExecSQL();
				   } else
				   {
				   vx1=ADOQuery1->FieldByName("id_sklad")->Value;
				   vx2=ADOQuery1->FieldByName("kolvo")->Value;
				   zap(9,3);
				   }
					break;
		   case 3:
					xval1=ComboBox1->Text;
					zap(5, 5);
					s1=xval1;
					xval1=ComboBox2->Text;
					zap(4, 5);
					s2=xval1;
					ADOQuery1->SQL->Text="update skladost set stoymzaed=:stoymzaed, kolvo=:kolvo, cena=:cena, pogr=:pogr where id_sklad=:id_sklad";
					ADOQuery1->Parameters->ParamByName("stoymzaed")->Value=Edit2->Text;
					ADOQuery1->Parameters->ParamByName("id_sklad")->Value=vx1;
					xkv=vx2.ToDouble()+Edit3->Text.ToDouble();
					ADOQuery1->Parameters->ParamByName("kolvo")->Value=xkv;
					ADOQuery1->Parameters->ParamByName("pogr")->Value=Edit6->Text;
					xse=Edit2->Text.ToDouble();
					xres=xse*xkv;
					ADOQuery1->Parameters->ParamByName("cena")->Value=xres;
					ADOQuery1->ExecSQL();
					break;
		   case 6:
					ADOQuery1->SQL->Text="delete from skladost where id_sklad=:id_sklad";
					ADOQuery1->Parameters->ParamByName("id_sklad")->Value=StringGrid1->Cells[8][StringGrid1->Row];
					ADOQuery1->ExecSQL();
					zap(9,1);
					break;
		   case 7:
					if (Edit5->Text.ToDouble()<=StringGrid1->Cells[5][StringGrid1->Row].ToDouble())
					{
					ADOQuery1->SQL->Text="select * from skladrash where naim=:naim";
					ADOQuery1->Parameters->ParamByName("naim")->Value=StringGrid1->Cells[1][StringGrid1->Row];
					ADOQuery1->Active=true;
					xval1=StringGrid1->Cells[3][StringGrid1->Row];
					zap(5, 5);
					s1=xval1;
					xval1=StringGrid1->Cells[4][StringGrid1->Row];
					zap(4, 5);
					s2=xval1;
					ADOQuery1->SQL->Text="insert into skladrash(naim, stoymzaed, kolvo, edizm, category, cena, data) values(:naim, :stoymzaed, :kolvo, :edizm, :category, :cena, :data)";
					ADOQuery1->Parameters->ParamByName("naim")->Value=StringGrid1->Cells[1][StringGrid1->Row];
					ADOQuery1->Parameters->ParamByName("stoymzaed")->Value=StringGrid1->Cells[2][StringGrid1->Row];
					ADOQuery1->Parameters->ParamByName("edizm")->Value=s1;
					ADOQuery1->Parameters->ParamByName("category")->Value=s2;
					ADOQuery1->Parameters->ParamByName("kolvo")->Value=Edit5->Text;
					xse=StringGrid1->Cells[2][StringGrid1->Row].ToDouble();
					xkv=Edit5->Text.ToDouble();
					xres=xse*xkv;
					ADOQuery1->Parameters->ParamByName("cena")->Value=xres;
					ADOQuery1->Parameters->ParamByName("data")->Value=DateTimePicker2->Date.DateString();
					ADOQuery1->ExecSQL();
					if (Edit5->Text.ToDouble()<StringGrid1->Cells[5][StringGrid1->Row].ToDouble())
						{
						ADOQuery1->SQL->Text="update skladost set stoymzaed=:stoymzaed, pogr=:pogr, kolvo=:kolvo, cena=:cena where id_sklad=:id_sklad";
						ADOQuery1->Parameters->ParamByName("stoymzaed")->Value=StringGrid1->Cells[2][StringGrid1->Row];
						ADOQuery1->Parameters->ParamByName("id_sklad")->Value=StringGrid1->Cells[8][StringGrid1->Row];
						xkv=StringGrid1->Cells[5][StringGrid1->Row].ToDouble()-Edit5->Text.ToDouble();
						ADOQuery1->Parameters->ParamByName("kolvo")->Value=xkv;
						ADOQuery1->Parameters->ParamByName("pogr")->Value=StringGrid1->Cells[7][StringGrid1->Row];
						xse=StringGrid1->Cells[2][StringGrid1->Row].ToDouble();
						xres=xse*xkv;
						ADOQuery1->Parameters->ParamByName("cena")->Value=xres;
						ADOQuery1->ExecSQL();
						}
					if (Edit5->Text.ToDouble()==StringGrid1->Cells[5][StringGrid1->Row].ToDouble())
						{
						ADOQuery1->SQL->Text="update skladost set stoymzaed=:stoymzaed, pogr=:pogr, kolvo=:kolvo, cena=:cena where id_sklad=:id_sklad";
						ADOQuery1->Parameters->ParamByName("stoymzaed")->Value=StringGrid1->Cells[2][StringGrid1->Row];
						ADOQuery1->Parameters->ParamByName("id_sklad")->Value=StringGrid1->Cells[8][StringGrid1->Row];
						xkv=0;
						ADOQuery1->Parameters->ParamByName("pogr")->Value=StringGrid1->Cells[7][StringGrid1->Row];
						ADOQuery1->Parameters->ParamByName("kolvo")->Value=xkv;
						xse=StringGrid1->Cells[2][StringGrid1->Row].ToDouble();
						xres=xse*xkv;
						ADOQuery1->Parameters->ParamByName("cena")->Value=xres;
						ADOQuery1->ExecSQL();
						}
					zap(9,1);
					}
				   break;
		 }
		 break;
 case 10: switch(y)
		 {
		   case 1:
				   clearmas();
				   Panel1->Visible=false;
				   Panel2->Visible=false;
				   Panel3->Visible=false;
				   Panel6->Visible=false;
				   Panel8->Visible=false;
				   Panel9->Visible=false;
				   Panel10->Visible=false;
				   Panel11->Visible=false;
				   Panel12->Visible=false;
				   Panel13->Visible=false;
				   Panel14->Visible=false;
				   Panel18->Visible=false;
				   Panel13->Visible=true;
				   Panel2->Visible=true;
				   Panel1->Visible=true;
				   Button17->Visible=false;
				   Button13->Visible=false;
				   Button20->Visible=false;
				   Button19->Visible=false;
				   Button18->Visible=false;
				   Button4->Visible=false;
				   Button3->Visible=false;
				   Button2->Visible=false;
				   Button2->Visible=true;
				   ADOQuery1->SQL->Text="select * from kvit order by dataopl desc";
				   ADOQuery1->Active=true;
				   a[1]="Номер п/п";
				   a[2]="Номер квитанции";
				   a[3]="Сумма";
				   a[4]="Дата";
				   a[5]="Сотрудник";
				   b[1]="id_kvit";
				   b[2]="summa";
				   b[3]="dataopl";
				   b[4]="ofic";
				   b[5]="id_kvit";
				   adtotab(5, StringGrid1);
				   break;
		   case 6:
					ADOQuery1->SQL->Text="delete from kvit where id_kvit=:id_kvit";
					ADOQuery1->Parameters->ParamByName("id_kvit")->Value=StringGrid1->Cells[5][StringGrid1->Row];
					ADOQuery1->ExecSQL();
					ADOQuery1->SQL->Text="delete from kvitspis where idkvit=:idkvit";
					ADOQuery1->Parameters->ParamByName("idkvit")->Value=StringGrid1->Cells[5][StringGrid1->Row];
					ADOQuery1->ExecSQL();
					zap(10,1);
					break;
		 }
		 break;
case 11: switch(y)
		 {
		   case 1:
				   clearmas();
				   ADOQuery1->SQL->Text="select * from kvitspis where idkvit=:idkvit";
				   ADOQuery1->Parameters->ParamByName("idkvit")->Value=StringGrid1->Cells[5][StringGrid1->Row];
				   ADOQuery1->Active=true;
				   a[1]="Блюдо";
				   a[2]="Цена";
				   a[3]="Количество";
				   b[1]="bludo";
				   b[2]="cena";
				   b[3]="kolvo";
				   b[4]="id_naim";
				   b[5]="idbludo";
				   adtotab2(3, StringGrid4);
				   break;
		 }
		 break;
 }
}

void TForm1::adtotab(int X,  TStringGrid *StringGrid1)
{
StringGrid1->ColCount=X;
StringGrid1->ColWidths[0]=57;
StringGrid1->ColWidths[1]=400;
StringGrid1->Cells[0][0]=a[1];
StringGrid1->Cells[1][0]=a[2];
StringGrid1->Cells[2][0]=a[3];
StringGrid1->Cells[3][0]=a[4];
StringGrid1->Cells[4][0]=a[5];
StringGrid1->Cells[5][0]=a[6];
StringGrid1->Cells[6][0]=a[7];
StringGrid1->Cells[7][0]=a[8];
StringGrid1->Cells[8][0]=a[9];
StringGrid1->Cells[9][0]=a[10];
StringGrid1->Cells[10][0]=a[11];
StringGrid1->Cells[11][0]=a[12];
StringGrid1->Cells[12][0]=a[13];
StringGrid1->Cells[13][0]=a[14];
StringGrid1->Cells[14][0]=a[15];
int i=1;
StringGrid1->RowCount=ADOQuery1->RecordCount+1;
  if (StringGrid1->RowCount>1)
  {
  StringGrid1->FixedCols=1;
  StringGrid1->FixedRows=1;
  }
  ADOQuery1->First();
  while (!ADOQuery1->Eof)
  {
	StringGrid1->Cells[0][i]=i;
	for (int j= 1; j<15; j++)
	{
	if (b[j]!="0") StringGrid1->Cells[j][i]=Trim(ADOQuery1->FieldByName(b[j])->Value);
	}
	i++;
	ADOQuery1->Next();
  }
}


void TForm1::adtotab2(int X,  TStringGrid *StringGrid1)
{
StringGrid1->ColCount=X;
StringGrid1->Cells[0][0]=a[1];
StringGrid1->Cells[1][0]=a[2];
StringGrid1->Cells[2][0]=a[3];
StringGrid1->Cells[3][0]=a[4];
StringGrid1->Cells[4][0]=a[5];
StringGrid1->Cells[5][0]=a[6];
StringGrid1->Cells[6][0]=a[7];
StringGrid1->Cells[7][0]=a[8];
StringGrid1->Cells[8][0]=a[9];
StringGrid1->Cells[9][0]=a[10];
StringGrid1->Cells[10][0]=a[11];
StringGrid1->Cells[11][0]=a[12];
StringGrid1->Cells[12][0]=a[13];
StringGrid1->Cells[13][0]=a[14];
StringGrid1->Cells[14][0]=a[15];
int i=1;
StringGrid1->RowCount=ADOQuery1->RecordCount+1;
  if (StringGrid1->RowCount>1)
  {
  StringGrid1->FixedCols=0;
  StringGrid1->FixedRows=1;
  }
  ADOQuery1->First();
  while (!ADOQuery1->Eof)
  {
	for (int j= 0; j<10; j++)
	{
	try
	{
	if (b[j+1]!="0") StringGrid1->Cells[j][i]=Trim(ADOQuery1->FieldByName(b[j+1])->Value);
	} catch(...){}
	}
	i++;
	ADOQuery1->Next();
  }
}


void TForm1::adtocb(TComboBox *cb, String val1)
{
cb->Items->Clear();
ADOQuery1->First();
while (!ADOQuery1->Eof){
 cb->Items->Add(Trim(ADOQuery1->FieldByName(val1)->Value));
 ADOQuery1->Next();
}
}

void TForm1::adtolb(TStringGrid *StringGrid1, String val1, String val2)
{
StringGrid1->RowCount=ADOQuery1->RecordCount;
int i=0;
ADOQuery1->First();
while (!ADOQuery1->Eof)
{
StringGrid1->Cells[0][i]=Trim(ADOQuery1->FieldByName(val1)->Value);
StringGrid1->Cells[1][i]=Trim(ADOQuery1->FieldByName(val2)->Value);
i++;
ADOQuery1->Next();
  }
}


void __fastcall TForm1::FormActivate(TObject *Sender)
{
/*
RichEdit1->PlainText=false;
RichEdit1->Text = "{\colortbl ;\red255\green0\blue0;\red0\green255\blue0;}";
RichEdit1->Text = "{\\rtf \
{\\colortbl ;\\red255\\green0\\blue0;\\red0\\green255\\blue0;}\
\\highlight2 Green\\highlight0 \\par \\cf1 Red\\cf0 \\par}";
RichEdit1->Repaint();
*/
zap(1,4);
Panel15->Width=Screen->Width;
Panel15->Height=Screen->Height;
Panel15->Left=0;
Panel15->Top=0;
Panel15->Visible=true;
Panel16->Left=Form1->Width/2-Panel16->Width/2;
Panel16->Top=Form1->Height/2-Panel16->Height/2;
Panel11->Visible=false;
Panel13->Visible=false;
Panel4->Visible=false;
Panel17->Visible=false;
StringGrid1->Visible=false;
}
//---------------------------------------------------------------------------
void __fastcall TForm1::Button1Click(TObject *Sender)
{
tab=1;
zap(tab,1);
Edit1->Text=StringGrid1->Cells[1][StringGrid1->Row];
Edit2->Text="";
ComboBox1->Text=StringGrid1->Cells[2][StringGrid1->Row];
}
//---------------------------------------------------------------------------
void __fastcall TForm1::Button6Click(TObject *Sender)
{
tab=3;
zap(tab,1);
zap(8,1);
Edit1->Text=StringGrid1->Cells[1][StringGrid1->Row];
Edit2->Text=StringGrid1->Cells[2][StringGrid1->Row];
ComboBox1->Text=StringGrid1->Cells[3][StringGrid1->Row];
}
//---------------------------------------------------------------------------
void __fastcall TForm1::Button5Click(TObject *Sender)
{
tab=2;
zap(tab,1);
Edit1->Text=StringGrid1->Cells[1][StringGrid1->Row];
}
//---------------------------------------------------------------------------
void __fastcall TForm1::Button3Click(TObject *Sender)
{
zap(tab, 3);
}
//---------------------------------------------------------------------------
void __fastcall TForm1::Button4Click(TObject *Sender)
{
zap(tab,2);
}
//---------------------------------------------------------------------------
void __fastcall TForm1::Button7Click(TObject *Sender)
{
tab=4;
zap(tab,1);
Edit1->Text=StringGrid1->Cells[1][StringGrid1->Row];
}
//---------------------------------------------------------------------------
void __fastcall TForm1::Button8Click(TObject *Sender)
{
tab=5;
zap(tab,1);
Edit1->Text=StringGrid1->Cells[1][StringGrid1->Row];
Edit2->Text=StringGrid1->Cells[2][StringGrid1->Row];
}
//---------------------------------------------------------------------------
void __fastcall TForm1::Button9Click(TObject *Sender)
{
tab=6;
zap(tab,1);
Edit1->Text=StringGrid1->Cells[1][StringGrid1->Row];
Edit2->Text=StringGrid1->Cells[2][StringGrid1->Row];
ComboBox1->Text=StringGrid1->Cells[3][StringGrid1->Row];
ComboBox2->Text=StringGrid1->Cells[4][StringGrid1->Row];
Edit3->Text=StringGrid1->Cells[5][StringGrid1->Row];
Edit6->Text=StringGrid1->Cells[7][StringGrid1->Row];
}
//---------------------------------------------------------------------------
void __fastcall TForm1::Button10Click(TObject *Sender)
{
tab=7;
zap(tab,1);
}
//---------------------------------------------------------------------------
void __fastcall TForm1::Button11Click(TObject *Sender)
{
StringGrid2->RowCount=StringGrid2->RowCount+1;
StringGrid2->FixedRows=1;
StringGrid2->Cells[0][StringGrid2->RowCount-1]=StringGrid3->Cells[0][StringGrid3->Row];
StringGrid2->Cells[1][StringGrid2->RowCount-1]=Edit4->Text;
StringGrid2->Cells[2][StringGrid2->RowCount-1]=StringGrid3->Cells[1][StringGrid3->Row];
}
//---------------------------------------------------------------------------

class TPublicGrid: public  TStringGrid
{
	public:
		using TStringGrid::DeleteRow;
};

void __fastcall TForm1::Button12Click(TObject *Sender)
{
((TPublicGrid*)StringGrid2)->DeleteRow(StringGrid2->Row);
}
//---------------------------------------------------------------------------
void __fastcall TForm1::StringGrid1Click(TObject *Sender)
{
switch (tab)
 {
	case 1:
			Edit1->Text=StringGrid1->Cells[1][StringGrid1->Row];
			Edit2->Text="";
			ComboBox1->Text=StringGrid1->Cells[2][StringGrid1->Row];
			break;
	case 2:
            Edit1->Text=StringGrid1->Cells[1][StringGrid1->Row];
			break;
	case 3:
			zap(8,1);
			Label8->Caption=StringGrid1->Cells[1][StringGrid1->Row];
			Edit1->Text=StringGrid1->Cells[1][StringGrid1->Row];
			Edit2->Text=StringGrid1->Cells[2][StringGrid1->Row];
			ComboBox1->Text=StringGrid1->Cells[3][StringGrid1->Row];
			break;
	case 4:
            Edit1->Text=StringGrid1->Cells[1][StringGrid1->Row];
			break;
	case 5:
            Edit1->Text=StringGrid1->Cells[1][StringGrid1->Row];
			Edit2->Text=StringGrid1->Cells[2][StringGrid1->Row];
			break;
	case 6:
            Edit1->Text=StringGrid1->Cells[1][StringGrid1->Row];
			Edit2->Text=StringGrid1->Cells[2][StringGrid1->Row];
			ComboBox1->Text=StringGrid1->Cells[3][StringGrid1->Row];
			ComboBox2->Text=StringGrid1->Cells[4][StringGrid1->Row];
			Edit3->Text=StringGrid1->Cells[5][StringGrid1->Row];
			Edit6->Text=StringGrid1->Cells[7][StringGrid1->Row];
			break;
	case 9:
			Label8->Caption=StringGrid1->Cells[1][StringGrid1->Row];
			break;
	case 10:
			zap(11,1);
			break;
 }
}
//---------------------------------------------------------------------------
void __fastcall TForm1::Button14Click(TObject *Sender)
{
Button16->Caption="Списать";
tab=9;
zap(tab,1);
}
//---------------------------------------------------------------------------

void __fastcall TForm1::Button2Click(TObject *Sender)
{
zap(tab,6);
}
//---------------------------------------------------------------------------

void __fastcall TForm1::Button13Click(TObject *Sender)
{
Label8->Caption=StringGrid1->Cells[1][StringGrid1->Row];
Panel11->Visible=true;
}
//---------------------------------------------------------------------------

void __fastcall TForm1::Button15Click(TObject *Sender)
{
Panel11->Visible=false;
}
//---------------------------------------------------------------------------

void __fastcall TForm1::Button16Click(TObject *Sender)
{
double a, b, c;
if (tab==9){zap(tab,7); }
if (tab==3)
{
int x1=0;
	for (int i = 1; i < StringGrid4->RowCount; i++)
	{
	if (Trim(StringGrid4->Cells[0][i])==Trim(StringGrid1->Cells[1][StringGrid1->Row])) x1=i;
	}
	if (x1==0)
	{
	StringGrid4->RowCount=StringGrid4->RowCount+1;
	StringGrid4->FixedRows=1;
	StringGrid4->Cells[0][StringGrid4->RowCount-1]=StringGrid1->Cells[1][StringGrid1->Row];
	StringGrid4->Cells[1][StringGrid4->RowCount-1]=Edit5->Text;
	StringGrid4->Cells[2][StringGrid4->RowCount-1]=StringGrid1->Cells[2][StringGrid1->Row];
	StringGrid4->Cells[4][StringGrid4->RowCount-1]=StringGrid1->Cells[4][StringGrid1->Row];
	double x, y, z;
	x=Edit5->Text.ToDouble();
	y=StringGrid1->Cells[2][StringGrid1->Row].ToDouble();
	z=x*y;
	StringGrid4->Cells[3][StringGrid4->RowCount-1]=z;
	}
	else
	{
	StringGrid4->Cells[0][x1]=StringGrid1->Cells[1][StringGrid1->Row];
	a=StringGrid4->Cells[1][x1].ToDouble();
	b=Edit5->Text.ToDouble();
	c=a+b;
	StringGrid4->Cells[1][x1]=c;
	StringGrid4->Cells[2][x1]=StringGrid1->Cells[2][StringGrid1->Row];
	StringGrid4->Cells[4][x1]=StringGrid1->Cells[4][StringGrid1->Row];
	double x, y, z;
	x=c;
	y=StringGrid1->Cells[2][StringGrid1->Row].ToDouble();
	z=x*y;
	StringGrid4->Cells[3][x1]=z;
	}
}
}
//---------------------------------------------------------------------------


void __fastcall TForm1::Button17Click(TObject *Sender)
{
Edit4->Text="0";
Panel10->Visible=!Panel10->Visible;
zap(8,1);
}
//---------------------------------------------------------------------------


void __fastcall TForm1::Button18Click(TObject *Sender)
{
Panel11->Visible=true;
Label8->Caption=StringGrid1->Cells[1][StringGrid1->Row];
Button16->Caption="Добавить";
}
//---------------------------------------------------------------------------

void __fastcall TForm1::Button19Click(TObject *Sender)
{
((TPublicGrid*)StringGrid4)->DeleteRow(StringGrid4->Row);
}
//---------------------------------------------------------------------------


void __fastcall TForm1::Button20Click(TObject *Sender)
{
zap(3,8);
}
//---------------------------------------------------------------------------

void __fastcall TForm1::Button21Click(TObject *Sender)
{
tab=10;
zap(tab,1);
zap(11,1);
}
//---------------------------------------------------------------------------

void __fastcall TForm1::FormResize(TObject *Sender)
{
Panel16->Left=Form1->Width/2-Panel16->Width/2;
Panel16->Top=Form1->Height/2-Panel16->Height/2;
}
//---------------------------------------------------------------------------



void __fastcall TForm1::Button22Click(TObject *Sender)
{
l=ComboBox3->Text;
p=Edit7->Text;
zap(1,5);
}
//---------------------------------------------------------------------------

void __fastcall TForm1::Button23Click(TObject *Sender)
{
zap(1,4);
Panel15->Width=Screen->Width;
Panel15->Height=Screen->Height;
Panel15->Left=0;
Panel15->Top=0;
Panel15->Visible=true;
Panel16->Left=Form1->Width/2-Panel16->Width/2;
Panel16->Top=Form1->Height/2-Panel16->Height/2;
Panel11->Visible=false;
Panel13->Visible=false;
Panel18->Visible=false;
Panel17->Visible=false;
Panel4->Visible=false;
StringGrid1->Visible=false;
}
//---------------------------------------------------------------------------

void __fastcall TForm1::BitBtn1Click(TObject *Sender)
{
if (tab==6) {
zap(6, 7);
double xc, yc, ac, bc;
xc=0;
yc=0;
ac=0;
bc=0;
for (int i = 1; i < StringGrid1->RowCount; i++) {
yc=StringGrid1->Cells[6][i].ToDouble();
xc=xc+yc;
bc=StringGrid1->Cells[5][i].ToDouble();
ac=bc+ac;
}
String xx=xc;
String xy=ac;
Label13->Caption="Сумма: "+xx+" "+"Количество: "+xy;
}
if (tab==7) {
zap(7, 7);
double xc, yc, ac, bc;
xc=0;
yc=0;
ac=0;
bc=0;
for (int i = 1; i < StringGrid1->RowCount; i++) {
yc=StringGrid1->Cells[6][i].ToDouble();
xc=xc+yc;
bc=StringGrid1->Cells[5][i].ToDouble();
ac=bc+ac;
}
String xx=xc;
String xy=ac;
Label13->Caption="Сумма: "+xx+" "+"Количество: "+xy;
}
}
//---------------------------------------------------------------------------

void __fastcall TForm1::FormClick(TObject *Sender)
{
DateTimePicker1->Date=Date();
DateTimePicker2->Date=Date();
DateTimePicker3->Date=Date();
DateTimePicker4->Date=Date();
}
//---------------------------------------------------------------------------


