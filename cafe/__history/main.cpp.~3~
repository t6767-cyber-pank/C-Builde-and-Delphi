//---------------------------------------------------------------------------

#include <vcl.h>
#pragma hdrstop

#include "main.h"
//---------------------------------------------------------------------------
#pragma package(smart_init)
#pragma resource "*.dfm"
TForm1 *Form1;
//---------------------------------------------------------------------------
__fastcall TForm1::TForm1(TComponent* Owner)
	: TForm(Owner)
{
}
//---------------------------------------------------------------------------
void __fastcall TForm1::FormActivate(TObject *Sender)
{
CategoryPanel3->Visible=false;
CategoryPanelGroup1->CollapseAll();
}
//---------------------------------------------------------------------------

void TForm1::clearmas()
{
for (int i = 0; i < 15; i++) {
a[i]="0";
b[i]="0";
}
}

void TForm1::zap(int x, int y)
{
ADOConnection1->Connected=false;
ADOConnection1->ConnectionString="Provider=SQLOLEDB.1;Password=timur666777;Persist Security Info=True;User ID=t67;Initial Catalog=kafe;Data Source=localhost";
ADOConnection1->Connected=true;
switch (x)
 {
 case 1: switch(y)
		 {
		   case 1:
				   clearmas();
				   Label1->Caption="Имя пользователя";
				   Label2->Caption="Пароль";
				   Label3->Caption="Статус пользователя";
				   CategoryPanel3->Visible=true;
				   ADOQuery1->SQL->Text="select * from polzov";
				   ADOQuery1->Active=true;
				   a[1]="Номер п/п";
				   a[2]="Ф.И.О";
				   a[3]="id_chel";
				   b[1]="fio";
				   b[2]="status";
				   b[3]="id_chel";
				   adtotab(13, StringGrid1);

				   break;
		 }
		 break;
 }
}

void TForm1::adtotab(int X,  TStringGrid *StringGrid1)
{
StringGrid1->ColCount=X;
StringGrid1->ColWidths[0]=57;
StringGrid1->ColWidths[1]=400;
StringGrid1->Cells[0][0]=a[1];
StringGrid1->Cells[1][0]=a[2];
StringGrid1->Cells[2][0]=a[3];
StringGrid1->Cells[3][0]=a[4];
StringGrid1->Cells[4][0]=a[5];
StringGrid1->Cells[5][0]=a[6];
StringGrid1->Cells[6][0]=a[7];
StringGrid1->Cells[7][0]=a[8];
StringGrid1->Cells[8][0]=a[9];
StringGrid1->Cells[9][0]=a[10];
StringGrid1->Cells[10][0]=a[11];
StringGrid1->Cells[11][0]=a[12];
StringGrid1->Cells[12][0]=a[13];
StringGrid1->Cells[13][0]=a[14];
StringGrid1->Cells[14][0]=a[15];
int i=1;
StringGrid1->RowCount=ADOQuery1->RecordCount+1;
  if (StringGrid1->RowCount>1)
  {
  StringGrid1->FixedCols=1;
  StringGrid1->FixedRows=1;
  }
  ADOQuery1->First();
  while (!ADOQuery1->Eof)
  {
	StringGrid1->Cells[0][i]=i;
	for (int j= 1; j<15; j++)
	{
	if (b[j]!="0") StringGrid1->Cells[j][i]=Trim(ADOQuery1->FieldByName(b[j])->Value);
	}
	i++;
	ADOQuery1->Next();
  }
}

void __fastcall TForm1::Button1Click(TObject *Sender)
{
zap(1,1);
}
//---------------------------------------------------------------------------

